{% extends 'base.html.twig' %}

{% block title %}Mon espace{% endblock %}

{% block body %}
    {% if app.user %}
        <header>
            <div class="border-bottom-0" id="container" >
                <div class="row d-flex justify-content-evenly align-items-center">
                    <div class="col-md-2 d-flex flex-column">
                        <img src="{{ asset('images/logo/logo.jpg') }}" alt="Logo" style="width: 150px; margin-left:2.5vw">
                    </div>
                    <div class="col-md-8">
                        <nav class="col-md-12 d-flex justify-content-between">
                            {% if is_granted('ROLE_ADMIN') %}
                                <a href="{{ path('app_admin') }}" class="text-decoration-none" >back-office</a>
                            {% endif %}
                            <a href="{{ path('app_home') }}" class="text-decoration-none">accueil</a>
                            <a href="{{ path('app_list_theme') }}" class="text-decoration-none">thÃ¨mes</a>
                            <a href="{{ path('app_my_space') }}" class="text-decoration-none" style="color: #00497C">mon espace</a>
                            <a href="{{ path('app_cart') }}" class="text-decoration-none" >panier</a>
                            <a href="{{ path('app_logout') }}" class="text-decoration-none" >se dÃ©connecter</a>
                        </nav>
                    </div>
                </div>
            </div>
        </header>
    {% endif %}
    <div id="container" style="padding-bottom: 15vh">
        <div id="container" class="row" style="margin: 5vw; background-color: #F1F8FC">
            <h2 style="margin-top: 5vh; margin-left: 1vw" >mon espace :</h2>
            {% if dataSource in ['orm', 'both'] %}
                {% for theme in themesSql %}
                    <div id="container" class="row" style="width: 90%;margin: 3%;padding: 3%;background-color: #FFFFFF">
                        <h2 style="margin-top: 5vh; margin-left: 1vw" >{{ theme.name }} : </h2>
                        {% set themeCert = null %}
                        {% for cert in certifications_sql %}
                            {% if cert.theme.name == theme.name %}
                                {% set themeCert = cert %}
                            {% endif %}
                        {% endfor %}

                        {% if themeCert %}
                            <p style="margin-left: 1vw">
                                ðŸŽ“ Certification "Knowledge Learning"<br>
                                Obtenue le : {{ themeCert.dateObtention ? themeCert.dateObtention|date('d/m/Y') : 'Non obtenu' }}
                            </p>
                        {% endif %}
                        {% for course in theme.courses %}
                            <div id="container" class="row" style="width: 90%;margin: 3%;padding: 3%;background-color: #F1F8FC">
                                <h2 style="margin-top: 5vh; margin-left: 1vw" >{{ course.title }} :</h2>
                                    {% for lesson in course.lessons %}
                                        <div id="container" class="row" style="width: 45%;margin: 3%;margin-left: 50%;padding: 3%; background-color: #FFFFFF">
                                            <a href="{{ path('app_detail_lesson', { id: lesson.id, source: 'orm' }) }}">
                                               <p class="text-center" style="margin-top: 2vh; margin-left: 1vw" > {{ lesson.title }}</p>
                                            </a>
                                        </div>
                                    {% endfor %}
                            </div>
                        {% endfor %}
                    </div>
                {% endfor %}
            {% endif %}
            {% if dataSource in ['mongodb', 'both'] %}
                {% for theme in themesMongo %}
                    <div id="container" class="row" style="width: 90%;margin: 3%;padding: 3%;background-color: #FFFFFF">
                        <h2 style="margin-top: 5vh; margin-left: 1vw" >{{ theme.name }} : </h2>
                        {% set themeCert = null %}
                        {% for cert in certifications_mongo %}
                            {% if cert.theme.name == theme.name %}
                                {% set themeCert = cert %}
                            {% endif %}
                        {% endfor %}

                        {% if themeCert %}
                            <p style="margin-left: 1vw">
                                ðŸŽ“ Certification "Knowledge Learning"<br>
                                Obtenue le : {{ themeCert.dateObtention ? themeCert.dateObtention|date('d/m/Y') : 'Non obtenu' }}
                            </p>
                        {% endif %}
                        {% for course in theme.courses %}
                            <div id="container" class="row" style="width: 90%;margin: 3%;padding: 3%;background-color: #F1F8FC">
                                <h2 style="margin-top: 5vh; margin-left: 1vw" >{{ course.title }} :</h2>
                                    {% for lesson in course.lessons %}
                                        <div id="container" class="row" style="width: 45%;margin: 3%;margin-left: 50%;padding: 3%; background-color: #FFFFFF">
                                            <a href="{{ path('app_detail_lesson', { id: lesson.id, source: 'mongodb' }) }}">
                                               <p class="text-center" style="margin-top: 2vh; margin-left: 1vw" > {{ lesson.title }}</p>
                                            </a>
                                        </div>
                                    {% endfor %}
                            </div>
                        {% endfor %}
                    </div>
                {% endfor %}
            {% endif %}
        </div>
    </div>
{% endblock %}